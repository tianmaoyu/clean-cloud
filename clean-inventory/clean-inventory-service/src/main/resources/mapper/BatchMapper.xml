<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.clean.inventory.mapper.BatchMapper">

    <resultMap id="BaseResultMap" type="org.clean.inventory.entity.Batch">
        <id property="batchId" column="batch_id" />
        <result property="materialId" column="material_id" />
        <result property="batchCode" column="batch_code" />
        <result property="productionDate" column="production_date" />
        <result property="expirationDate" column="expiration_date" />
        <result property="supplierId" column="supplier_id" />
        <result property="supplierBatch" column="supplier_batch" />
        <result property="qualityStatus" column="quality_status" />
        <result property="notes" column="notes" />
        <result property="createdAt" column="created_at" />
<!--        <result property="attributeJson" column="attribute_json" javaType="map"/>-->
        <result property="attributeJson" column="attribute_json" />
    </resultMap>

    <sql id="Base_Column_List">
        batch_id,material_id,batch_code,production_date,expiration_date,supplier_id,
        supplier_batch,quality_status,notes,created_at,attribute_json
    </sql>

    <!-- 批量插入 -->
    <insert id="insertBatchSomeColumn" parameterType="java.util.List">
        INSERT INTO batch
        (material_id, batch_code, production_date, expiration_date, supplier_id, 
         supplier_batch, quality_status, notes, created_at, attribute_json)
        VALUES
        <foreach collection="list" item="item" separator="," >
            (#{item.materialId},
             #{item.batchCode},
             #{item.productionDate},
             #{item.expirationDate},
             #{item.supplierId},
             #{item.supplierBatch},
             #{item.qualityStatus},
             #{item.notes},
             #{item.createdAt},
             #{item.attributeJson}::jsonb)
        </foreach>
    </insert>
</mapper>
